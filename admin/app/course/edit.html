<!DOCTYPE html>
<html lang="zh" >
<meta charset="utf-8">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title></title>
	<meta name="keywords" content="">
	<meta name="description" content="">
	<link rel="shortcut icon" href="favicon.ico">
	<link href="/assets/admin/css/bootstrap.min.css" rel="stylesheet"/>
	<link href="/assets/admin/css/font-awesome.min.css" rel="stylesheet"/>
	<!-- bootstrap-table 表格插件样式 -->
	<link href="/assets/admin/ajax/libs/bootstrap-table/bootstrap-table.min.css" rel="stylesheet"/>
	<link href="/assets/admin/ajax/libs/bootstrap-treetable/bootstrap-treetable.css" rel="stylesheet"/>
	<link href="/assets/admin/ajax/libs/bootstrap-table/extensions/columns/bootstrap-table-fixed-columns.css" rel="stylesheet"/>
	<link href="/assets/admin/css/animate.css" rel="stylesheet"/>
	<link href="/assets/admin/css/style.css" rel="stylesheet"/>
	<link href="/assets/admin/ajax/libs/select/select2.css" rel="stylesheet"/>
	<link href="/assets/admin/ruoyi/css/ry-ui.css" rel="stylesheet"/>
	
	<link href="/assets/admin/ajax/libs/ion-rangeslider/css/ion.rangeSlider.css" rel="stylesheet"/>
	<link href="/assets/admin/ajax/libs/ion-rangeslider/css/ion.rangeSlider.skinFlat.css" rel="stylesheet"/>
	<link href="/assets/umeditor/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
	
</head>
<body>
    <div class="form-content" id="app">
        <form id="form-user-add" class="form-horizontal">
            <input name="id" type="hidden" value="#(obj.id)"/>
            <h4 class="form-header h4">基本信息</h4>
            <div class="row">
            	<div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label"><span style="color: red; ">*</span>课程标题：</label>
                        <div class="col-sm-8">
                            <input name="title" autocomplete="off" placeholder="请输入课程标题" :value="obj.title" class="form-control" type="text" maxlength="200" required>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">副标题：</label>
                        <div class="col-sm-8">
                            <input name="name" autocomplete="off" placeholder="请输入副标题" value="#(obj.name)" class="form-control" type="text" >
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label"><span style="color: red; ">*</span>课程类型：</label>
                        <div class="col-sm-8">
                            <select id="type" name="type" class="form-control">
                            	<option #(obj.type=='公开课'?'selected':'')>公开课</option>
                            	<option #(obj.type=='精品'?'selected':'')>精品</option>
                            	<option #(obj.type=='套餐'?'selected':'')>套餐</option>
                            	<option #(obj.type=='PRO'?'selected':'')>PRO</option>
                            	<option #(obj.type=='VIP'?'selected':'')>VIP</option>
                            	<option #(obj.type=='SOLE'?'selected':'')>SOLE</option>
                            </select>
                            <small>vip为专享课程</small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                	<div class="form-group">
                        <label class="col-sm-4 control-label">宣传片：</label>
                        <div class="col-sm-8">
		                    <input name="vid" placeholder="宣传片vid" :value="obj.oldprice" class="form-control" type="text">
                        	<small>存在宣传片则输入宣传片的vid</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
            	<div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">价格：</label>
                        <div class="col-sm-8">
		                    <input name="price" placeholder="价格" :value="obj.price" class="form-control" type="text">
		                    <small>1元=1研值=100积分</small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">原价：</label>
                        <div class="col-sm-8">
		                    <input name="oldprice" placeholder="原价" :value="obj.oldprice" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                
            </div>
            
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">所属机构：</label>
                        <div class="col-sm-8">
                            <select id="agency_id" v-model="obj.unit_id" class="form-control">
                            	<option value="0">心教育</option>
                            	<option value="1">中科博爱</option>
                            	<option value="2">合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">分成比例：</label>
                        <div class="col-sm-8">
                            <input type="text" class="rangeslider1" name="pct" value="5">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
            	<div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">观看类型：</label>
                        <div class="col-sm-8">
                            <label class="check-box">
								<input name="mold" type="checkbox" value="1">爱好者</input>
							</label><label class="check-box">
								<input name="mold" type="checkbox" value="2">工作者</input>
							</label>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">会议回放：</label>
                        <div class="col-sm-8">
                            <select name="meet" class="form-control" multiple="multiple">
                            	<option >个人成长</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">咨询领域：</label>
                        <div class="col-sm-8">
                            <select name="field" class="form-control" multiple="multiple">
                            	<option >个人成长</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">服务人群：</label>
                        <div class="col-sm-8">
                            <select name="crowd" class="form-control" multiple="multiple">
                            	<option >亲子</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">技术流派：</label>
                        <div class="col-sm-8">
                            <select name="sect" class="form-control" multiple="multiple">
                            	<option >个人成长</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">咨询案例：</label>
                        <div class="col-sm-8">
                            <select name="cases" class="form-control" multiple="multiple">
                            	<option >亲子</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">认证课程：</label>
                        <div class="col-sm-8">
                            <select name="auth" class="form-control" >
                            	<option >个人成长</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">培训录播：</label>
                        <div class="col-sm-8">
                            <select name="train" class="form-control" >
                            	<option >亲子</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">讲师类型：</label>
                        <div class="col-sm-8">
                            <select name="ttype" class="form-control" multiple="multiple">
                            	<option >个人成长</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">其他门类：</label>
                        <div class="col-sm-8">
                            <select name="other" class="form-control" multiple="multiple">
                            	<option >亲子</option>
                            	<option >中科博爱</option>
                            	<option >合作单位</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">qq：</label>
                        <div class="col-sm-8">
                            <input name="qq" autocomplete="off" placeholder="请输入副qq" :value="obj.qq" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">电话：</label>
                        <div class="col-sm-8">
                            <input name="phone" autocomplete="off" placeholder="请输入电话" :value="obj.phone" class="form-control" type="text">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label"><span style="color: red; ">*</span>排序：</label>
                        <div class="col-sm-8">
                            <input name="sort" autocomplete="off" placeholder="请输入排序" :value="obj.sort" class="form-control" type="text" maxlength="11" required>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="col-sm-4 control-label">课程状态：</label>
                        <div class="col-sm-8">
		                    <input type="radio" name="status" value="1" class="" checked="checked">上架
		                    <input type="radio" name="status" value="0" class="" >下架
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
            	<div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">课程标签：</label>
                        <div class="col-xs-10">
                            <select id="tag" name="tag" data-placeholder="点击查找标签" class="form-control select2-hidden-accessible" multiple="">
								<option selected="selected" value="高考">高考</option>
							</select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
            	<div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">讲师：</label>
                        <div class="col-xs-10">
                            <select id="teacher" name="tid" data-placeholder="点击查找讲师" class="form-control select2-hidden-accessible" multiple="">
								<option selected="selected" value="1">心教育</option>
							</select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
            <div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">封面：</label>
                        <div class="col-xs-10">
							<button type="button" id="add" class="btn" >添加章节</button><br/>
							<table class="table table-hover">
								<thead>
									<tr>
										<th>类型</th>
										<th>标题</th>
										<th>值</th>
										<th>免费播放</th>
										<th>操作</th>
									</tr>
								</thead>
								<tbody id="chapters">
									<tr v-for="item in obj.chapter">
							<td>
							<select v-model="item.type" name="chapter.type" class="form-control">
							<option value="mulu">章节</option>
							<option value="course">课程</option>
							<option value="video">视频</option>
							<option value="test">练习</option>
							<option value="file">文件</option>
							</select>
							</td>
							<td><input class="form-control" name="chapter.title" :value="item.title" placeholder="标题" /></td>
							<td><input class="form-control" name="chapter.val" :value="item.val" placeholder="值" /></td>
							<td><select v-model="item.open" name="chapter.open" class="form-control">
							<option >否</option>
							<option >是</option>
							</select></td>
							<td><a class="btn btn-danger btn-xs " onclick="remove(this);"><i class="fa fa-remove"></i>删除</a></td>
							</tr>
								</tbody>
							</table>
							<script type="template" id="addtpl">
							<tr>
							<td>
							<select name="chapter.type" class="form-control">
							<option value="mulu">章节</option>
							<option value="course">课程</option>
							<option value="video">视频</option>
							<option value="test">练习</option>
							<option value="file">文件</option>
							</select>
							</td>
							<td><input class="form-control" name="chapter.title" placeholder="标题" /></td>
							<td><input class="form-control" name="chapter.val" placeholder="值" /></td>
							<td><select name="chapter.open" class="form-control">
							<option selected>否</option>							
							<option >是</option>
							</select></td>
							<td><a class="btn btn-danger btn-xs " onclick="remove(this);"><i class="fa fa-remove"></i>删除</a></td>
							</tr>
							</script>
                        </div>
                    </div>
                </div>
            </div>
            <h4 class="form-header h4">编辑信息</h4>
            <div class="row">
            	<div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">封面：</label>
                        <div class="col-xs-10">
								    <input name="img" type="hidden" :value="obj.img">
								    <button type="button" id="imgbtn" class="btn" >上传图片</button><br/>
							<img onerror="this.src='/img/wutu.png'" alt="src" style="width: 400px;height: 235px;" id="imgshow" src="http://www.iepsy.com/#(obj.img)">
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">文本信息：</label>
                        <div class="col-xs-10">
                            <textarea v-model="obj.text" name="text" autocomplete="off" maxlength="500" class="form-control" rows="5"></textarea>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">扩展信息：</label>
                        <div class="col-xs-10">
                            <textarea v-model="obj.extend" name="extend" autocomplete="off" maxlength="500" class="form-control" rows="4"></textarea>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">图文信息：</label>
                        <div class="col-xs-10">
                            <textarea v-model="obj.html" style="width:100%;height:240px;" name="html" id="html" autocomplete="off" maxlength="500" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    <div class="row">
        <div class="col-sm-offset-5 col-sm-10">
            <button type="button" class="btn btn-sm btn-primary" onclick="submitHandler()"><i class="fa fa-check"></i>保 存</button>&nbsp;
            <button type="button" class="btn btn-sm btn-danger" onclick="closeItem()"><i class="fa fa-reply-all"></i>关 闭 </button>
        </div>
    </div>
	</div>
	<script src="/assets/vue/vue.js"></script>
	<script src="/assets/admin/js/jquery.min.js"></script>
	<script src="/assets/admin/js/bootstrap.min.js"></script>
	
	<!-- bootstrap-table 表格插件 -->
	<script src="/assets/admin/ajax/libs/bootstrap-table/bootstrap-table.min.js"></script>
	<script src="/assets/admin/ajax/libs/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
	<script src="/assets/admin/ajax/libs/bootstrap-table/extensions/mobile/bootstrap-table-mobile.js"></script>
	<script src="/assets/admin/ajax/libs/bootstrap-table/extensions/toolbar/bootstrap-table-toolbar.min.js"></script>
	<script src="/assets/admin/ajax/libs/bootstrap-table/extensions/columns/bootstrap-table-fixed-columns.js"></script>
	<!-- jquery-validate 表单验证插件 -->
	<script src="/assets/admin/ajax/libs/validate/jquery.validate.min.js"></script>
	<script src="/assets/admin/ajax/libs/validate/messages_zh.min.js"></script>
	<script src="/assets/admin/ajax/libs/validate/jquery.validate.extend.js"></script>
	<!-- jquery-validate 表单树插件 -->
	<script src="/assets/admin/ajax/libs/bootstrap-treetable/bootstrap-treetable.js"></script>
	<!-- jquery-export 表格导出插件 -->
	<script src="/assets/admin/ajax/libs/bootstrap-table/extensions/export/bootstrap-table-export.js"></script>
	<script src="/assets/admin/ajax/libs/bootstrap-table/extensions/export/tableExport.js"></script>
	<!-- 遮罩层 -->
	<script src="/assets/admin/ajax/libs/blockUI/jquery.blockUI.js"></script>
	<script src="/assets/admin/ajax/libs/iCheck/icheck.min.js"></script>
	<script src="/assets/admin/ajax/libs/layer/layer.min.js"></script>
	<script src="/assets/admin/ajax/libs/layui/layui.js"></script>
	<script src="/assets/admin/ruoyi/js/common.js?v=3.2.0"></script>
	<script src="/assets/admin/ruoyi/js/ry-ui.js?v=3.2.0"></script>
	
	<script> var ctx = "\/"; </script>
	<script src="/assets/admin/ajax/libs/select/select2.js"></script>
	<script src="/assets/admin/ajax/libs/ion-rangeslider/js/ion.rangeSlider.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="/assets/umeditor/umeditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="/assets/umeditor/umeditor.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/assets/jquery/upload.js"></script>
	<script>
	var initobj={type:"公开课",label:"公开课","unit_id":0,"sort":0,price:0,oldprice:0}
		var app=new Vue({
			el:"#app",
			data:{
				obj:#(json(obj)!=""?json(obj):'initobj')
			},
			created(){
	　　　　　　　　　　　　//如果没有这句代码，select中初始化会是空白的，默认选中就无法实现
	          	
	        },
			methods:{
				
			}
		})
	
	var um = UM.getEditor('html');
	</script>
	<script>
	    var prefix = ctx + "admin/app/course";
	
	    $(function(){
	    	
	    	$("#add").click(function(){
	    		$("#chapters").append($("#addtpl").html())
	    	})
	    	$("#imgbtn").click(function() {
		    	$.upload({
	                // 上传地址
	                url: '/api/up/up.json?path=upload/course/img/', 
	                // 文件域名字
	                fileName: 'file', 
	                // 其他表单数据
	                params: {type: 'course'},
	                // 上传完成后, 返回json, text
	                dataType: 'json',
	                // 上传之前回调,return true表示可继续上传
	                onSend: function() {
	                        return true;
	                },
	                // 上传之后回调
	                onComplate: function(data) {
	                	app.obj.img=data.file;
	                      $("#imgshow").attr("src","#(root)"+data.file);
	                }
	        	});
	    	})
	    	
	    	$('.rangeslider1').ionRangeSlider({min: 1,max: 100});
	    	$('#tag').select2({
		    	  ajax: {
		    	    url: ctx+'admin/app/tag/list',
		    	    data: function (params) {
		    	        var query = {
		    	          name: params.term,
		    	          pageNum: params.page || 1
		    	        }
		    	        return query;
		    	    },
		    	    dataType: 'json',
		    	    processResults: function (data) {
				      return {
				        results: data,
				        "pagination": {
				            "more": true
				        }
				      };
				    }
		    	  }
		   });
	    	$('#teacher').select2({
		    	  ajax: {
		    	    url: ctx+'admin/app/teacher/list',
		    	    data: function (params) {
		    	        var query = {
		    	          name: params.term,
		    	          pageNum: params.page || 1
		    	        }
		    	        return query;
		    	    },
		    	    dataType: 'json',
		    	    processResults: function (data) {
				      return {
				        results: data,
				        "pagination": {
				            "more": true
				        }
				      };
				    }
		    	  }
		   });
	    })
	    
	    
        $("#form-user-add").validate({
        	rules:{
        	},
        	messages: {
                "loginName": {
                    remote: "用户已经存在"
                },
        		"email": {
                    remote: "Email已经存在"
                },
        		"phonenumber":{
                	remote: "手机号码已经存在"
        		}
            },
            focusCleanup: true
        });
        
        function submitHandler() {
	        if ($.validate.form()) {
	        	var data = $("#form-user-add").serializeArray();
	        	app.obj.tname=$("#teacher option:selected").text();
	        	data.push({name: "tname",value:app.obj.tname});
	        	$.operate.saveTab(prefix + "/save", data);
	        	closeItem()
	        }
	    }
		function remove(item){
			item.parentNode.parentNode.parentNode.removeChild(item.parentNode.parentNode);
		}
    </script>
</body>
</html>
