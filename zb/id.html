<!DOCTYPE html>
<html lang="zh-CN">
 <head> 
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
  <title>#(obj.title)-直播-心教育</title> 
  <link rel="stylesheet" href="#(root)assets/layui/css/layui.css">
  <link rel="stylesheet" href="#(root)css/zb/id.css" /> 
  <link rel="stylesheet" href="https://g.alicdn.com/de/prismplayer/2.7.2/skins/default/aliplayer-min.css" /> 
<style type="text/css">
.prism-ErrorMessage{display: none;}
</style>
</head> 
 <body style=""> 
  <div id="root"> 
   <div style=" background-position: center;background-color: black;" class="roomV2_app_out" > 
    <div class="roomV2_app" > 
     <div class="wrapper wrapper_big program_or_alternate_room_or_lottery_room" > 
      <div class="top_content" > 
       <div class="middle_area"> 
        <div class="room_actor_info clearfix" > 
         <a href="/zb/" class="avatar" style="font-size: 25px;color: white;">返回</a> 
         <div class="info" > 
          <div class="room_theme clearfix" >
         	#(obj.title)
          </div> 
          <div class="level_nickname_sun" > 
           <span class="nickname" >#(obj.teacher)</span>
           <span class="audience_count" >8440</span>
          </div> 
         </div> 
         <div class="follow_share_info clearfix" > 
          <div class="follow_info" > 
           <span class="do_follow" ><span >取消收藏</span></span> 
          </div> 
          <div class="share" > 
           <span class="main_text" >分享</span> 
           <div class="share_box" > 
            <div class="blank" > 
             <i ></i> 
            </div> 
            <div class="main" > 
             <div class="title" >
              精彩直播，分享给小伙伴
             </div> 
             
             <div class="share_to_weixin" > 
              <div class="title" >
               	扫码分享到微信
              </div> 
              <img class="qrcode" src="" /> 
             </div> 
             
            </div> 
           </div> 
          </div> 
          <a target="_blank" class="report" ><span class="main_text" >举报</span></a> 
         </div> 
        </div> 
        <div class="player_wrap" > 
         <div class="player_inner" > 
          <div id="player_container" style="width: 100%; height: 100%;" > 
          </div> 
          <div id="gamesWrap" ></div> 
         </div> 
        </div> 
       </div> 
       <div class="right_aside" > 
        <div class="chat_content" > 
         <div class="msg_sys_list"  style="height: 70px;"> 
          <div class="FreeScrollbar" style="overflow: hidden; height: 100%; position: relative;" > 
           <div class="FreeScrollbar-scrollbar" style="position: absolute; top: 0px; right: 0px; height: 100%;" > 
            <div class="FreeScrollbar-handler hide" style="top: 93.295%; position: absolute; z-index: 1; height: 6.70498%;" ></div> 
           </div> 
           <div class="FreeScrollbar-scroller" style="overflow-y: scroll; overflow-x: hidden; height: 100%; position: absolute; top: 0px; left: 0px; bottom: 0px; right: -20px; padding-right: 20px;" > 
            <div class="chat_item system" > 
             <div class="info" > 
              <span style="color: #78aeff;" data-reactid=".1eydcc9s8hc.1.b.0.1.1.0.0.1.$k1.0.0">系统消息</span>
              <span >：</span>
              <span >大舞台，正能量，共同守护我们的网络家园（敬请关注官方公告）。</span> 
             </div> 
            </div> 
            
           </div> 
          </div> 
         </div> 
         <a class="control" style="top: 80px;"><span class="line" data-reactid=".1eydcc9s8hc.1.b.0.1.1.1.0"></span><span class="icon" data-reactid=".1eydcc9s8hc.1.b.0.1.1.1.1"></span></a> 
         <div class="msg_chat_list" style="top: 90px;"> 
          <div class="FreeScrollbar" style="overflow: hidden; height: 100%; position: relative;" > 
           <div class="FreeScrollbar-scrollbar" style="position: absolute; top: 0px; right: 0px; height: 100%;" > 
            <div class="FreeScrollbar-handler hide" style="top: 80.1133%; position: absolute; z-index: 1; height: 19.8867%;" ></div> 
           </div> 
           <div id="chatlist" class="FreeScrollbar-scroller" style="overflow-y: scroll; overflow-x: hidden; height: 100%; position: absolute; top: 0px; left: 0px; bottom: 0px; right: -20px; padding-right: 20px;" > 
            
            
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="chat_input" > 
         <div class="border_line" ></div> 
         
         <div class="ibox" > 
          <div class="l_box" > 
           <textarea id="text" class="" maxlength="256" placeholder="一起来聊聊吧" ></textarea> 
          </div> 
          <a class="send_btn" >发送</a> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
  <script type="text/javascript" src="/js/zepto.min.js"></script> 
  <script type="text/javascript" src="https://g.alicdn.com/de/prismplayer/2.7.2/aliplayer-min.js?e9924dc6efc693521e7f"></script> 
  <script>
var pmheight=window.screen.availHeight-150;
var player = new Aliplayer({
	    id: "player_container",
	    source: "#(video.url)",
	    width: "100%",
	    height: pmheight+"px",
	    autoplay: #(video.islive??false),
	    preload: false,
	    isLive: #(video.islive??false),
	    rePlay:false,
	    playsinline:true,
	    preload:false,
	    controlBarVisibility:"hover",
	    useH5Prism:true,
	    cover: "#(www)#(obj.img)"
	  }, function (player) {
	    console.log("播放器创建成功");
	  });
</script> 
  <script src="#(root)assets/layui/layui.js"></script> 
  <script>

//一般直接写在一个js文件中
layui.use(['layer', 'form','element','carousel'], function(){
	var $ = layui.jquery;
  var layer = layui.layer
  ,form = layui.form;
  var carousel = layui.carousel;
  //layer.msg('Hello World');
 	$("#chatplan").css("height",pmheight+"px")
 	
 	var ws;
		var WS_URL = window.location.host + '' + "/ws/zb?id=#(obj.id)"
		console.log(WS_URL)
		if (location.protocol == 'http:') {
			ws = new WebSocket("ws://"+WS_URL);
		} else { // 如果页面是https,那么必须走wss协议
			ws = new WebSocket("wss://"+WS_URL);
		}
		ws.onmessage = function(event) {
			var chat=JSON.parse(event.data);
			console.log(chat)
			$("#chatlist").append("<div class=\"chat_item s_\" > \n" +
			"             <div class=\"info\" > \n" +
			"              <a class=\"nickname s\" href=\"javascript:\" data-userid=\""+chat.uid+"\" style=\"margin-right: 0px;\" >"+chat.nickname+"</a>\n" +
			"              <span >：</span>\n" +
			"              <span class=\"content\" ><span >"+chat.text+"</span></span> \n" +
			"             </div> \n" +
			"            </div> ")
		}
		ws.onopen = function(event) {
			ws.send(JSON.stringify({"room":"#(obj.id)","send_time":new Date().getTime(),"uid":"#(session.user.id)","nickname":"#(session.user.nickname)","text":"来了"}));
		};
		
		$(".send_btn").click(function(){
			ws.send(JSON.stringify({"room":"#(obj.id)","send_time":new Date().getTime(),"uid":"#(session.user.id)","nickname":"#(session.user.nickname)","text":$("#text").val()}));
			$("#text").val("")
		})
});
</script> 
<script>
layui.use(['layer'],function(){
	var $=layui.$,layer=layui.layer;
	$(".weixin-icon").click(function(){
		layer.open({
		    type: 2,
		    title:false,
		    shade: false,
		    maxmin: false, //开启最大化最小化按钮
		    area: ['125px', '120px'],
		    content: '/images/qrcode.png'
		  });
	})
        //显示隐藏  
	$("#userlogindiv").hover(function(){
		$("#mod_head_notice_pop").show();
	},function(){
	});
	$("#mod_head_notice_pop").hover(function(){
	},function(){
		$("#mod_head_notice_pop").hide();
	});
})
</script>
 </body>
</html>